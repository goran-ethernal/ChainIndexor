common_db: &common_db
  journal_mode: WAL
  synchronous: NORMAL
  busy_timeout: 5000
  cache_size: 10000
  max_open_connections: 25
  max_idle_connections: 5
  enable_foreign_keys: true

# Optional: Logging configuration
logging:
  default_level: "info"       # default log level: "debug", "info", "warn", "error"
  development: false          # enable development mode (stack traces, console encoder)
  # Optional: Per-component log levels
  component_levels:
    downloader: "info"
    log-fetcher: "info"
    sync-manager: "info"
    reorg-detector: "warn"
    log-store: "info"
    maintenance: "info"

# Optional: Prometheus metrics configuration
metrics:
  enabled: true               # enable metrics collection and HTTP endpoint
  listen_address: ":9090"     # address to expose metrics (default: ":9090")
  path: "/metrics"            # metrics endpoint path (default: "/metrics")

downloader:
  rpc_url: "https://mainnet.infura.io/v3/XXXX"
  chunk_size: 5000            # block range per eth_getLogs call
  finality: "finalized"       # "finalized", "safe", or "latest"
  # Optional: RPC retry configuration with exponential backoff
  retry:
    max_attempts: 5           # maximum number of attempts (including initial request)
    initial_backoff: 1s       # initial backoff duration before first retry
    max_backoff: 30s          # maximum backoff duration
    backoff_multiplier: 2.0   # multiplier for exponential backoff
  db:
    <<: *common_db
    path: "./data/downloader.sqlite"
  # Optional: Log retention policy
  retention_policy:
    # Maximum database size in MB (0 = unlimited)
    max_db_size_mb: 1000
    # Maximum blocks to keep from the latest indexed block (0 = unlimited)
    max_blocks: 100000
  maintenance:
    enabled: true                   # enable maintenance tasks
    check_interval: "5m"            # run maintenance every 5 minutes
    vacuum_on_startup: true         # vacuum database on startup
    wal_checkpoint_mode: "TRUNCATE" # WAL checkpoint mode: "PASSIVE", "FULL", "RESTART", "TRUNCATE"

indexers:
  - name: "MyTokenIndexer"
    type: "erc20"            # indexer type (e.g., "erc20", "erc721", or your custom type)
    start_block: 17000000    # block to start indexing from
    db:
      <<: *common_db
      path: "./data/mytokenindexer.sqlite"
    contracts:
      - address: "0x1234567890abcdef1234567890abcdef12345678"
        events:
          - "Transfer(address,address,uint256)"

# Optional: API server configuration
api:
  enabled: true                # enable REST API server
  listen_address: ":8080"      # API server listen address
  # Optional: HTTP server timeouts (uncomment to customize)
  # read_timeout: 30s          # max duration for reading request (default: 30s)
  # write_timeout: 30s         # max duration for writing response (default: 30s)
  # idle_timeout: 120s         # max duration for idle keep-alive connections (default: 120s)
  cors:
    enabled: true              # enable CORS
    allowed_origins:           # allowed origins (* for all)
      - "*"
